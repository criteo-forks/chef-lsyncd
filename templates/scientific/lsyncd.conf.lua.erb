-- Managed by Chef; Using lsync 2.1 config sytax

settings {
  logfile = "<%= node['lsyncd']['settings']['logfile'] %>",
  statusFile = "<%= node['lsyncd']['settings']['statusFile'] %>",
  maxDelays = <%= node['lsyncd']['settings']['maxDelays'] %>,
  maxProcesses = <%= node['lsyncd']['settings']['maxProcesses'] %>,
  statusInterval = <%= node['lsyncd']['settings']['statusInterval'] %>,
  insist = <%= node['lsyncd']['settings']['insist'] %>
}

-- Hacky way of doing conf.d style configs
local confdir = '<%= node['lsyncd']['settings']['conf_d'] %>/'
local entries = readdir( confdir )

for name, isdir in pairs( entries ) do
    if not isdir then
        dofile( confdir .. name )
    end
end
