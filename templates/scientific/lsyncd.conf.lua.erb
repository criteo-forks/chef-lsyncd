-- Managed by Chef; Using lsync 2.1 config sytax

settings {
  logfile = "<%= node['lsyncd']['settings']['logfile'] %>",
  statusFile = "<%= node['lsyncd']['settings']['statusFile'] %>",
  maxDelays = <%= node['lsyncd']['settings']['maxDelays'] %>,
  maxProcesses = <%= node['lsyncd']['settings']['maxProcesses'] %>,
  statusInterval = <%= node['lsyncd']['settings']['statusInterval'] %>,
  insist = <%= node['lsyncd']['settings']['insist'] %>
}

-- Hacky way of doing conf.d style configs
package.path = "/etc/lsyncd/conf.d/?.lua;" .. package.path
local f = io.popen("ls /etc/lsyncd/conf.d/*.lua|xargs -n1 basename|sed 's/.lua//'") for mod in f:lines() do require(mod) end
