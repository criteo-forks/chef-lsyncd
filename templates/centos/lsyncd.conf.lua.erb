-- Managed by Chef; Using lsync 2.1 config sytax

settings {
  logfile = "<%= node['lsyncd']['log_file'] %>",
  statusFile = "<%= node['lsyncd']['status_file'] %>",
  maxDelays = <%= node['lsyncd']['max_delays'] %>,
  maxProcesses = <%= node['lsyncd']['max_processes'] %>,
  statusInterval = <%= node['lsyncd']['interval'] %>,
  insist = <%= node['lsyncd']['insist'] %>,
}

-- Hacky way of doing conf.d style configs
local confdir = '<%= node['lsyncd']['conf_d'] %>/'
local entries = readdir( confdir )

for name, isdir in pairs( entries ) do
    if not isdir then
        dofile( confdir .. name )
    end
end
